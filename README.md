# fluorescence-analysis
Данный код создает программу для анализа концентрации аналита по флуоресцентным изображениям тест-полосок с использованием библиотек компьютерного зрения и машинного обучения. Программа автоматически создаст необходимые директории и проведет вас через процесс калибровки и анализа.
Вот что делает программа:
1. Позволяет выбрать область интереса (ROI) на тест-полоске.
2. Выполняет предварительную обработку изображений.
3. Извлекает интенсивность флуоресценции, анализируя яркость и насыщенность.
4. Строит калибровочную кривую на основе образцов с известными концентрациями.
5. Предсказывает концентрацию аналита для новых образцов.
6. Визуализирует результаты анализа, включая:
   - Исходное изображение
   - Выделенную область интереса
   - Гистограмму яркости
   - Калибровочную кривую с отметкой текущего образца.

Для использования программы вам потребуется:
1. Набор калибровочных изображений с известными концентрациями.
2. Изображения исследуемых образцов.
3. Библиотеки Python: `OpenCV`, `NumPy`, `Matplotlib` и `scikit-learn`.

Особенности.
1. Линейная зависимость в логарифмических координатах: калибровочная кривая строится как зависимость интенсивности флуоресценции от десятичного логарифма концентрации (lg₁₀(концентрации)). Используется простая линейная модель вместо полиномиальной.
2. Концентрации преобразуются в логарифмические значения перед построением модели. Проверяется, что все концентрации положительные (для возможности логарифмирования)
3. Сохраняются коэффициенты линейной регрессии (наклон и пересечение).
4. Предсказания концентрации. Для этого используется обратное преобразование: сначала вычисляется lg(концентрации), затем восстанавливается реальная концентрация через потенцирование ($10^x$).
5. Графики строятся в координатах "интенсивность от log₁₀(концентрации)". На графиках отображается уравнение линии и значение R². Форматирование вывода концентрации в научной нотации.
5. В результатах и на графиках отображаются как сама концентрация, так и её логарифм.
6. Присутствуют проверки корректности данных (положительные концентрации, ненулевой наклон). Этот подход соответствует распространённому методу калибровки в аналитической химии, где часто наблюдается линейная зависимость сигнала от логарифма концентрации.
7. Концентрации калибровочных растворов автоматически извлекаются из имён файлов, поэтому при сохранении фотографий тест-полосок их имена должны соответствовать концентрациям раствора аналита, нанесенных на них. Поддерживаются различные форматы имен: conc_1.23.jpg, 1.23-conc.jpg, просто 1.23.jpg и т.д.
8. Возможно сохранение/загрузка калибровочных данных для повторного использования (сохраняется в файле `calibration_data.npy).
9. Реализовано автоматическое сохранение графиков калибровки и результатов анализа.
10. Все результаты записываются в текстовый файл analysis_results.txt для удобного доступа.
11. Организация работы с файлами:
   - Создается директория для результатов анализа.
   - Графики сохраняются с высоким разрешением (300 dpi).
   - Программа проверяет наличие сохраненной калибровки и предлагает её использовать.
